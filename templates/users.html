{% extends 'base.html' %}
{% block content %}
<section class="card">
  <h2>Novo usuário</h2>
  <form method="post" class="grid form-grid">
    <input name="name" placeholder="Nome" required />
    <input type="email" name="email" placeholder="E-mail" required />
    <input type="password" name="password" placeholder="Senha" minlength="6" required />
    <label class="checkbox-inline admin-inline"><input type="checkbox" name="is_admin" /> <span>Administrador</span></label>
    <button type="submit">Criar usuário</button>
  </form>
</section>
<section class="card">
  <h2>Usuários cadastrados</h2>
  <div class="table-wrap">
    <table>
      <thead><tr><th>Nome</th><th>E-mail</th><th>Perfil</th><th>Criação</th><th>Ações</th></tr></thead>
      <tbody>
        {% for u in users %}
        <tr>
          <td>{{ u.name }}</td>
          <td>{{ u.email }}</td>
          <td>{{ 'Admin' if u.is_admin else 'Operador' }}</td>
          <td>{{ u.created_at.strftime('%d/%m/%Y %H:%M') }}</td>
          <td>
            <div class="action-group">
              <details>
                <summary class="btn-edit">Editar</summary>
                <form method="post" action="{{ url_for('editar_usuario', user_id=u.id) }}" class="inline-form user-edit-form">
                  <input name="name" value="{{ u.name }}" required />
                  <input type="email" name="email" value="{{ u.email }}" required />
                  <input type="password" name="password" minlength="6" placeholder="Nova senha (opcional)" />
                  <label class="checkbox-inline admin-inline"><input type="checkbox" name="is_admin" {% if u.is_admin %}checked{% endif %}/> <span>Administrador</span></label>
                  <button type="submit">Salvar</button>
                </form>
              </details>
              <form method="post" action="{{ url_for('remover_usuario', user_id=u.id) }}" onsubmit="return confirm('Deseja remover este usuário?');">
                <button type="submit" class="btn-danger">Remover</button>
              </form>
            </div>
          </td>
        </tr>
        {% else %}<tr><td colspan="5">Sem usuários.</td></tr>{% endfor %}
      </tbody>
    </table>
  </div>
</section>
{% endblock %}
